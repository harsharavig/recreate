import{j as e}from"./index-DkyWHF8O.js";import{r as s}from"./vendor-CRb3ZNvc.js";import{c as t}from"./supabase-bNDkVZ62.js";import{m as i}from"./motion-CwSfUfFn.js";import{H as a}from"./utils-j4oi1-vl.js";var o=(e,s,t)=>new Promise((i,a)=>{var o=e=>{try{r(t.next(e))}catch(s){a(s)}},l=e=>{try{r(t.throw(e))}catch(s){a(s)}},r=e=>e.done?i(e.value):Promise.resolve(e.value).then(o,l);r((t=t.apply(e,s)).next())});const l=t("https://qvzbuzvswxrygqllbsvi.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF2emJ1enZzd3hyeWdxbGxic3ZpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE1NDA0NzAsImV4cCI6MjA2NzExNjQ3MH0.c2vbVAf_tvhu8gxykHsIdOeC2W7_RuzO4F-PAGBG2ug"),r=e=>{const[t,i]=s.useState(0),[a,r]=s.useState(!1),[n,c]=s.useState(!0),[d,u]=s.useState("");s.useEffect(()=>{o(void 0,null,function*(){try{const e=yield fetch("https://api.ipify.org?format=json");return(yield e.json()).ip}catch(e){return`anonymous_${Math.random().toString(36).substring(2,11)}`}}).then(u)},[]);const m=s.useCallback(()=>o(void 0,null,function*(){if(d)try{const{count:s}=yield l.from("blog_likes").select("*",{count:"exact",head:!0}).eq("blog_slug",e);i(s||0);const{data:t}=yield l.from("blog_likes").select("id").eq("blog_slug",e).eq("user_ip",d).maybeSingle();r(!!t)}catch(s){}finally{c(!1)}}),[e,d]);s.useEffect(()=>{d&&m()},[m,d]);const g=s.useCallback(()=>o(void 0,null,function*(){if(d&&!n)try{a?(yield l.from("blog_likes").delete().eq("blog_slug",e).eq("user_ip",d),i(e=>e-1),r(!1)):(yield l.from("blog_likes").insert([{blog_slug:e,user_ip:d}]),i(e=>e+1),r(!0))}catch(s){m()}}),[e,d,a,n,m]);return{likeCount:t,isLiked:a,isLoading:n,toggleLike:g}},n=({blogSlug:s,className:t=""})=>{const{likeCount:o,isLiked:l,isLoading:n,toggleLike:c}=r(s);return e.jsxs(i.button,{onClick:c,disabled:n,className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-all duration-200 ${l?"bg-red-500/20 text-red-400 hover:bg-red-500/30":"bg-gray-800 text-gray-400 hover:bg-gray-700 hover:text-red-400"} disabled:opacity-50 disabled:cursor-not-allowed ${t}`,whileHover:{scale:1.05},whileTap:{scale:.95},children:[e.jsx(i.div,{animate:{scale:l?[1,1.3,1]:1},transition:{duration:.3},children:e.jsx(a,{size:18,fill:l?"currentColor":"transparent",className:"transition-colors duration-200"})}),e.jsx("span",{className:"text-sm font-medium",children:n?"...":o})]})},c=({name:s,className:t="",showImage:i=!0,imageSize:a="sm"})=>e.jsxs("div",{className:`flex items-center gap-2 ${t}`,children:[i&&e.jsx("img",{src:"/assets/profile-pic.jpg",alt:s,className:`${{sm:"w-6 h-6",md:"w-8 h-8",lg:"w-12 h-12"}[a]} rounded-full object-cover border border-gray-600`}),e.jsx("span",{className:"text-gray-400 text-sm",children:s})]});export{c as A,n as B};
